import{h as R,p as g,g as X,n as h,u as G,r as O,i as q,o as v,w as Q,c as P,f as C,S as n,d as l,Q as U,b as u,T as w,U as A}from"./app-CDcD9CqU.js";import{G as $}from"./tools-BnXVOVZL.js";import{_ as m}from"./MyIcon.vue_vue_type_style_index_0_lang-M_6estlz.js";import"./commonjsHelpers-Cpj98o6Y.js";const j={class:"Mo7PreviewBox-topBar"},J=["href"],K=["src","alt"],Z={class:"Mo7PreviewBox-idxView"},ee={class:"Mo7PreviewBox-idxView-box"},te={class:"Mo7PreviewBox-idxView-idx"},oe={key:0,class:"Mo7PreviewBox-idxView-alt"},ie={key:1,class:"Mo7PreviewBox-idxView-key"},ae=R({__name:"PreviewImage",setup(ne){let f=g({}),c=g([]),y=g(!1),s=g(0);function D(){y.value=!1,document.body.style.overflow="auto"}function p(){const e=document.getElementById("Mo7PreviewBox-img");if(!e)return;let o=e.clientWidth,t=e.clientHeight;o=o*1.1,e.style.width=o+"px",t=t*1.1,e.style.height=t+"px"}function x(){const e=document.getElementById("Mo7PreviewBox-img");if(!e)return;let o=e.clientWidth,t=e.clientHeight;o=o*.9,e.style.width=o+"px",t=t*.9,e.style.height=t+"px"}function L(){const e=document.getElementById("Mo7PreviewBox-img");e&&window.open(e.getAttribute("src"))}function S(){s.value>0&&s.value--,h(()=>{E()})}function T(){s.value<c.value.length-1&&s.value++,h(()=>{E()})}function E(){const e=document.getElementById("Mo7PreviewBox");if(!e)return;const o=e.clientWidth,t=e.clientHeight,i=document.getElementById("Mo7PreviewBox-img");if(!i)return;i.style.width=o*.9+"px",i.style.height="",i.style.maxWidth="",i.style.maxHeight="",i.style.left="",i.style.top="",i.style.cursor="",i.clientHeight>t&&(i.style.width="",i.style.height=t*.9+"px")}function V(e){const t=e.target.getAttribute("src");let i=s.value;for(let r=0;r<c.value.length;r++)if(c.value[r].src===t){i=r;break}s.value=i,y.value=!0,document.body.style.overflow="hidden",h(()=>{E()})}function d(e){e.type=="wheel"&&(e.deltaY>0?x():p()),e.key==="Enter"&&L(),e.key==="Escape"&&D(),e.key==="ArrowUp"&&p(),e.key==="ArrowDown"&&x(),e.key==="ArrowLeft"&&S(),e.key==="ArrowRight"&&T()}function B(e){let o=document.getElementById("markdown-content");if(!o)return;const t=o.getElementsByTagName("img"),i=[];for(let r=0;r<t.length;r++){const a=t[r];e==="bind"&&i.push({alt:a.getAttribute("alt"),src:a.getAttribute("src")}),a.removeEventListener("click",V),document.removeEventListener("keyup",d),e==="bind"&&(a.addEventListener("click",V),document.addEventListener("keyup",d))}c.value=i,document.removeEventListener("keyup",d),e==="bind"&&f.isPC&&document.addEventListener("keyup",d),document.removeEventListener("wheel",d),e==="bind"&&f.isPC&&document.addEventListener("wheel",d)}let _=!1,k=0,b=0,I=0,M=0;function F(e){if(!_)return;const o=e.clientX-k,t=e.clientY-b,i=I+o,r=M+t,a=document.getElementById("Mo7PreviewBox-img");a&&(a.style.left=i+"px",a.style.top=r+"px")}function Y(){const e=document.getElementById("Mo7PreviewBox-img");e&&(e.style.cursor="default"),_=!1,k=0,b=0,I=0,M=0}function H(e){const o=document.getElementById("Mo7PreviewBox-img");o&&(o.style.cursor="move"),_=!0,k=e.clientX,b=e.clientY;let t;window.getComputedStyle?t=window.getComputedStyle(o,null):t=o.currentStyle,I=parseInt(t.left),M=parseInt(t.top)}function W(e){e.type==="touchmove"&&e.touches.length==1&&F(e.touches[0]),e.type==="mousemove"&&F(e)}function z(e){Y()}function N(e){e.type==="touchstart"&&e.touches.length==1&&H(e.touches[0]),e.type==="mousedown"&&H(e)}return X(()=>{f=$(),console.info("DeviceInfo",f),h(()=>{B("bind")});const e=G();e.beforeEach((o,t)=>{o.path!==t.path&&B("unbind")}),e.afterEach((o,t)=>{o.path!==t.path&&h(()=>{setTimeout(()=>{B("bind")},1e3)})})}),(e,o)=>{const t=O("ClientOnly");return v(),q(t,null,{default:Q(()=>[n(y)?(v(),P("div",{key:0,id:"Mo7PreviewBox",onMousemove:W,onTouchmove:W,onMouseup:z,onTouchend:z},[l("div",j,[l("div",{class:U(["btn",{hide:n(s)===0}]),onClick:S},[u(m,{class:"icon",name:"xiangzuo"})],2),l("div",{class:U(["btn",{hide:n(s)===n(c).length-1}]),onClick:T},[u(m,{class:"icon",name:"xiangyou"})],2),l("div",{class:"btn",onClick:w(p,["stop"])},[u(m,{class:"icon",name:"fangda"})]),l("div",{class:"btn",onClick:w(x,["stop"])},[u(m,{class:"icon",name:"suoxiao"})]),l("div",{class:"btn",onClick:w(L,["stop"])},[u(m,{class:"icon",name:"quanping"})]),l("a",{class:"btn",href:n(c)[n(s)].src,download:""},[u(m,{class:"icon",name:"xiazai"})],8,J),l("div",{class:"btn",onClick:w(D,["stop"])},[u(m,{class:"icon",name:"guanbi"})])]),l("img",{id:"Mo7PreviewBox-img",onMousedown:N,onTouchstart:N,src:n(c)[n(s)].src,alt:n(c)[n(s)].alt,srcset:""},null,40,K),l("div",Z,[l("div",ee,[l("div",te,A(n(s)+1)+"/"+A(n(c).length),1),n(c)[n(s)].alt?(v(),P("div",oe,A(n(c)[n(s)].alt),1)):C("v-if",!0),n(f).isPC?(v(),P("div",ie," 快捷键:放大↑，缩小↓，上一张←，下一张→，新页面打开↵，Esc关闭预览 ")):C("v-if",!0)])])],32)):C("v-if",!0)]),_:1})}}});export{ae as default};
